(function(e){function t(t){for(var r,a,o=t[0],s=t[1],u=t[2],f=0,d=[];f<o.length;f++)a=o[f],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);c&&c(t);while(d.length)d.shift()();return l.push.apply(l,u||[]),n()}function n(){for(var e,t=0;t<l.length;t++){for(var n=l[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==i[s]&&(r=!1)}r&&(l.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},l=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=s;l.push([1,"chunk-vendors"]),n()})({0:function(e,t){},"030f":function(e,t,n){},"034f":function(e,t,n){"use strict";n("85ec")},"07af":function(e,t,n){"use strict";n("ac87")},"0c4c":function(e,t,n){"use strict";n("c7f3")},"0cb2":function(e,t,n){},1:function(e,t,n){e.exports=n("56d7")},2:function(e,t){},"241e":function(e,t,n){"use strict";n("0cb2")},"3e06":function(e,t,n){},"429b":function(e,t,n){"use strict";n("030f")},"4f49":function(e,t,n){"use strict";n("6a82")},"56d7":function(e,t,n){"use strict";n.r(t);n("a7cc"),n("450d");var r=n("df33"),i=n.n(r),l=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.fillSum,expression:"fillSum"}],staticClass:"sum-input",attrs:{placeholder:"需要填的数量"},domProps:{value:e.fillSum},on:{input:function(t){t.target.composing||(e.fillSum=t.target.value)}}}),n("button",{staticClass:"btn",on:{click:e.restart}},[e._v("重来")])]),n("div",{staticStyle:{"font-size":"25px"}},[e._v("时间:"+e._s(e.gameTime))]),n("div",{staticStyle:{display:"grid","grid-template-columns":"repeat(2, auto)"}},[n("div",{staticStyle:{display:"grid","grid-template-rows":"repeat(2, auto)","justify-items":"center"}},[n("Table",{attrs:{table:e.table}}),n("ButtonGroup",{attrs:{table:e.table}})],1),n("div",[n("ChartRoom",{ref:"chartRoom",attrs:{user:e.user}})],1)]),e._v(" "+e._s(e.table.id)+" "),n("Dialog",{ref:"dialog"},[n("input",{attrs:{placeholder:"怎么称呼"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitName(t)}}})])],1)},o=[],s=(n("96cf"),n("1da1")),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return void 0!==this.table.boxs?n("div",{staticClass:"table",style:e.tableStyle},e._l(this.table.getBoxs(),(function(e,t){return n("Box",{key:t,attrs:{box:e}})})),1):e._e()},c=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.boxStyle},e._l(e.box.getCells(),(function(e,t){return n("Cell",{key:t,attrs:{cell:e}})})),1)},d=[],h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"cell",style:e.cellStyle,on:{click:function(t){return e.fillGap(t)}}},[n("span",{style:e.valueStyle},[e._v(e._s(e.cell.value)+" ")])])},v=[],p=(n("7db0"),n("d81d"),n("2ef0")),b=n.n(p),g=n("48e8"),m=g.Realtime,y=n("356c"),x=new m({appId:"gOmqUStGjqpV2o8oMJpeq2qD-gzGzoHsz",appKey:"fv1R6bFH7HBEGpIbYjhVRf0I",server:"https://gomqustg.lc-cn-n1-shared.com"});function w(e){var t=x.createIMClient(e);return t}function k(e){var t=e.getQuery().equalTo("tr",!0);return t.find()}function C(e,t){var n=y.Object.extend("Table"),r=new n,i=b.a.cloneDeep(t);delete i.positionMap,r.set("code",e),r.set("data",{cells:t.getCells().map((function(e){return{x:e.x,y:e.y,value:e.value,needFill:e.needFill}}))}),r.save().then((function(e){console.log("保存成功。objectId：".concat(e.id))}),(function(e){console.log("失败了"),console.error(e)}))}function j(){var e=new y.Query("Table");return e.first()}function S(e){var t=e.remoteTable;t.set("data",{cells:e.getCells().map((function(e){return{x:e.x,y:e.y,value:e.value,needFill:e.needFill}}))}),t.save().then((function(e){console.log("保存成功。objectId：".concat(e.id))}),(function(e){console.log("失败了"),console.error(e)}))}function O(e){var t=new y.Query("Table");t.subscribe().then((function(t){t.on("update",(function(t){e(t)}))}))}y.init({appId:"gOmqUStGjqpV2o8oMJpeq2qD-gzGzoHsz",appKey:"fv1R6bFH7HBEGpIbYjhVRf0I",serverURL:"https://gomqustg.lc-cn-n1-shared.com"});var _={props:["cell"],methods:{fillGap:function(e){var t=this;if(!1!==this.cell.allowFill&&!1!==this.cell.needFill){this.$parent.$parent.$parent.$emit("startGame"),"×"===this.$root.curIndex?(this.cell.value=void 0,S(this.cell.table)):this.cell.value=this.$root.curIndex;var n=this.cell.table.verify(this.cell);if(n)S(this.cell.table),this.cell.table.verifyPass()&&(window.clearInterval(this.$parent.$parent.$parent.timeId),alert("恭喜你通关了"));else{this.cell.value=void 0;var r=e.target.style.background;e.target.style.background="#eb2d2d46",this.cell.allowFill=!1,setTimeout((function(){e.target.style.background=r,t.cell.allowFill=!0}),500)}}}},computed:{valueStyle:function(){return this.cell.needFill?{color:"green","font-size":"35px"}:{"font-size":"25px"}},cellStyle:function(){return this.cell.hint?{background:"#0000004f",color:"#fff"}:{}}},mounted:function(){this.cell.value===this.$root.curIndex&&(this.cell.hint=!0)}},E=_,$=(n("241e"),n("2877")),M=Object($["a"])(E,h,v,!1,null,"12cefd83",null),I=M.exports,R={props:["box"],components:{Cell:I},computed:{boxStyle:function(){return{display:"grid","grid-template-columns":"repeat(3, 50px)","grid-template-rows":"repeat(3, 50px)",border:"2px solid #000"}}}},B=R,T=Object($["a"])(B,f,d,!1,null,null,null),P=T.exports,F={props:["table"],components:{Box:P},data:function(){return{curIndex:"1"}},computed:{tableStyle:function(){return{cursor:'url("./images/'+this.$root.curIndex+'.png") 1 1, auto'}}},mounted:function(){console.log()}},G=F,q=(n("429b"),Object($["a"])(G,u,c,!1,null,"12d28948",null)),z=q.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"margin-top":"20px"}},e._l(e.buttons,(function(t,r){return n("button",{key:r,class:e.$root.curIndex===t.label?"btn-handle btn-handle-active":"btn-handle",on:{click:function(n){return e.click(t)}}},[e._v(" "+e._s(t.label)+" ")])})),0)},V=[],A=(n("4de4"),n("4160"),n("159b"),{props:["table"],data:function(){return{buttons:[{label:"1"},{label:"2"},{label:"3"},{label:"4"},{label:"5"},{label:"6"},{label:"7"},{label:"8"},{label:"9"},{label:"×"}]}},methods:{click:function(e){this.$root.curIndex=e.label,this.table.getCells().filter((function(t){return t.hint=!1,t.value===e.label})).forEach((function(e){e.hint=!0}))}},mounted:function(){var e=arguments,t=this;document.onkeydown=function(n){var r=n||event||window.event||e.callee.caller.arguments[0],i="1";switch(r.keyCode){case 48:i="×";break;case 49:i="1";break;case 50:i="2";break;case 51:i="3";break;case 52:i="4";break;case 53:i="5";break;case 54:i="6";break;case 55:i="7";break;case 56:i="8";break;case 57:i="9";break}t.click({label:i})}}}),D=A,H=(n("07af"),Object($["a"])(D,L,V,!1,null,"2aadb2aa",null)),N=H.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],staticStyle:{width:"300px",height:"468px","margin-top":"30px"},attrs:{readonly:""},domProps:{value:e.msg},on:{input:function(t){t.target.composing||(e.msg=t.target.value)}}}),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.willSendMsg,expression:"willSendMsg"}],domProps:{value:e.willSendMsg},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter(t)},input:function(t){t.target.composing||(e.willSendMsg=t.target.value)}}})])])},Q=[],U=(n("a15b"),n("b0c0"),n("48e8")),K=U.Event,W={props:["user"],computed:{msg:function(){return this.msgList.join("\n")}},data:function(){return{msgList:[],willSendMsg:""}},methods:{onEnter:function(){var e=this;this.user.sendMsg(this.user.name+":"+this.willSendMsg).then((function(){e.willSendMsg=""}))},startListen:function(){var e=this;this.user.data.on(K.MESSAGE,(function(t){e.msgList.push(t.text)}))}},mounted:function(){}},Y=W,X=(n("5f82"),Object($["a"])(Y,J,Q,!1,null,null,null)),Z=X.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"请问",visible:e.dialogVisible,width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"custom-dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e._t("default"),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],2)},te=[],ne={data:function(){return{dialogVisible:!0}}},re=ne,ie=(n("4f49"),Object($["a"])(re,ee,te,!1,null,null,null)),le=ie.exports,ae=(n("99af"),n("ac1f"),n("1276"),n("b85c")),oe=n("d4ec"),se=n("bee2"),ue=function(){function e(t,n,r,i,l){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];Object(oe["a"])(this,e),this.x=n,this.y=r,this.box=i,this.weights=100,this.value=void 0===t?void 0:String(t),this.table=l,this.needFill=a,this.hint=!1,this.allowFill=!0}return Object(se["a"])(e,[{key:"setBlank",value:function(){var e=this;this.value=void 0,this.box.getCells().filter((function(e){return void 0!==e.value})).forEach((function(e){return e.weights=e.weights-1})),this.table.getCells().filter((function(t){return t.x===e.x&&void 0!==t.value})).forEach((function(e){return e.weights=e.weights-1})),this.table.getCells().filter((function(t){return t.y===e.y&&void 0!==t.value})).forEach((function(e){return e.weights=e.weights-1})),this.needFill=!0}}],[{key:"filterCellsByBoxPosition",value:function(e,t,n){if(e<0||e>2)throw new Error("x不在范围内");if(t<0||t>2)throw new Error("x不在范围内");var r=[];return 0===e?r=n.filter((function(e){return e.x>=0&&e.x<3})):1===e?r=n.filter((function(e){return e.x>2&&e.x<6})):2===e&&(r=n.filter((function(e){return e.x>5&&e.x<=9}))),0===t?r=r.filter((function(e){return e.y>=0&&e.y<3})):1===t?r=r.filter((function(e){return e.y>2&&e.y<6})):2===t&&(r=r.filter((function(e){return e.y>5&&e.y<=9}))),r}}]),e}(),ce=ue,fe=function(){function e(t,n){Object(oe["a"])(this,e),this.x=t,this.y=n,this.cells=[],this.weights=100}return Object(se["a"])(e,[{key:"addCell",value:function(e){this.cells.push(e)}},{key:"setCells",value:function(e){var t=this;e.forEach((function(e){e.box=t})),this.cells=e}},{key:"getCells",value:function(){return this.cells}}]),e}(),de=fe,he=function(){function e(){Object(oe["a"])(this,e),this.boxs=[]}return Object(se["a"])(e,[{key:"addBox",value:function(e){this.boxs.push(e)}},{key:"getBoxs",value:function(){return this.boxs}},{key:"getCells",value:function(){var e=this;if(void 0!==this.cells)return this.cells;var t=[];return this.boxs.forEach((function(e){t=t.concat(e.getCells())})),this.cells=t,this.positionMap={},this.cells.forEach((function(t){e.positionMap[String(t.x)+String(t.y)]=t})),t}},{key:"findCellByPosition",value:function(e){return this.positionMap[e]}},{key:"getMaxWeightsCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.getCells().filter((function(e){return void 0!==e.value}));if(t.sort((function(e,t){return e.weights>t.weights?-1:1})),0==e)return t[0];e>t.length-1&&(e=t.length-1);var n=b.a.random(0,e,!1);return t[n]}},{key:"getRowCells",value:function(e){return this.getCells().filter((function(t){return t.x===e}))}},{key:"getColumnCells",value:function(e){return this.getCells().filter((function(t){return t.y===e}))}},{key:"verify",value:function(e){var t,n=e.box,r=n.getCells().filter((function(t){return t.x!==e.x||t.y!==e.y})),i=Object(ae["a"])(r);try{for(i.s();!(t=i.n()).done;){var l=t.value;if(l.value===e.value)return!1}}catch(v){i.e(v)}finally{i.f()}var a,o=this.getRowCells(e.x).filter((function(t){return t.x!==e.x||t.y!==e.y})),s=Object(ae["a"])(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.value===e.value)return!1}}catch(v){s.e(v)}finally{s.f()}var c,f=this.getColumnCells(e.y).filter((function(t){return t.x!==e.x||t.y!==e.y})),d=Object(ae["a"])(f);try{for(d.s();!(c=d.n()).done;){var h=c.value;if(h.value===e.value)return!1}}catch(v){d.e(v)}finally{d.f()}return!0}},{key:"verifyPass",value:function(){var e,t=this.getCells(),n=Object(ae["a"])(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(void 0===r.value)return!1;if(!1===this.verify(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}]),e}(),ve=he,pe=[[1,2,3,4,5,6,7,8,9],[4,5,6,7,8,9,1,2,3],[7,8,9,1,2,3,4,5,6],[8,9,1,2,3,4,5,6,7],[2,3,4,5,6,7,8,9,1],[5,6,7,8,9,1,2,3,4],[6,7,8,9,1,2,3,4,5],[9,1,2,3,4,5,6,7,8],[3,4,5,6,7,8,9,1,2]],be=function(){for(var e=b.a.cloneDeep(pe),t=[[0,1,2],[3,4,5],[6,7,8]],n=[[0,1,2],[3,4,5],[6,7,8]],r=[],i=0;i<3;i++){var l=t[i],a=b.a.random(0,2,!1);b.a.pullAt(l,a),r.push(a);var o=[e[l[1]],e[l[0]]];e[l[0]]=o[0],e[l[1]]=o[1]}for(var s=0;s<3;s++){var u=n[s],c=b.a.random(0,2,!1);r.push(c),b.a.pullAt(u,c);var f,d=Object(ae["a"])(e);try{for(d.s();!(f=d.n()).done;){var h=f.value,v=[h[u[1]],h[u[0]]];h[u[0]]=v[0],h[u[1]]=v[1]}}catch(k){d.e(k)}finally{d.f()}}for(var p=new ve,g=0;g<3;g++)for(var m=0;m<3;m++)p.addBox(new de(g,m));for(var y=[],x=function(t){y=y.concat(e[t].map((function(e,n){return new ce(e,t,n,void 0,p)})))},w=0;w<e.length;w++)x(w);return p.getBoxs().forEach((function(e){var t=ce.filterCellsByBoxPosition(e.x,e.y,y);e.setCells(t)})),{table:p,codeArr:r}},ge=function(e){var t=e.get("data").cells,n=new ve;n.code=e.get("code"),n.remoteTable=e;for(var r=0;r<3;r++)for(var i=0;i<3;i++)n.addBox(new de(r,i));var l=t.map((function(e){return new ce(e.value,e.x,e.y,void 0,n,e.needFill)}));return n.getBoxs().forEach((function(e){var t=ce.filterCellsByBoxPosition(e.x,e.y,l);e.setCells(t)})),n},me=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:49,t=be(),n=t.table,r=t.codeArr,i=0;i<e;i++){var l=n.getMaxWeightsCell(5);r.push(String(l.x)+String(l.y)),l.setBlank()}var a=r.join("");return C(a,n),{data:n,code:a}},ye=n("48e8"),xe=ye.TextMessage,we=function(){function e(t){Object(oe["a"])(this,e),this.name=t}return Object(se["a"])(e,[{key:"login",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w(this.name);case 2:this.data=e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"joinChartRoom",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("开始加入聊天室"),e.next=3,k(this.data);case 3:return n=e.sent,n=n[0],e.next=7,this.getConversation(n);case 7:this.conversation=e.sent,this.msgList=t,this.conversation.join().then((function(){r.sendMsg("欢迎["+r.name+"]光临")}));case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getConversation",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.data.getConversation(t.id));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sendMsg",value:function(e){return this.msgList.push(e),this.conversation.send(new xe(e))}}]),e}(),ke=we,Ce={name:"App",components:{Table:z,ButtonGroup:N,ChartRoom:Z,Dialog:le},data:function(){return{table:{},fillSum:49,gameTime:0,timeId:void 0,user:void 0}},methods:{restart:function(){var e=this;this.fillSum<10||this.fillSum>80?alert("你别玩了"):/^\d+$/.test(this.fillSum)?(this.gameTime=0,this.table=me(this.fillSum),this.$once("startGame",(function(){e.timeId=setInterval((function(){e.gameTime++}),1e3)}))):alert("输个阳间数")},submitName:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.target.value,r){n.next=3;break}return n.abrupt("return");case 3:return t.user=new ke(r),n.next=6,t.user.login();case 6:t.user.joinChartRoom(t.$refs.chartRoom.msgList),t.$refs.chartRoom.startListen(),t.$refs.dialog.dialogVisible=!1;case 9:case"end":return n.stop()}}),n)})))()},initTable:function(){var e=this;j().then((function(t){e.table=ge(t)}))}},mounted:function(){var e=this;this.$once("startGame",(function(){e.timeId=setInterval((function(){e.gameTime++}),1e3)})),this.initTable(),O((function(t){e.table=ge(t)}))}},je=Ce,Se=(n("034f"),n("0c4c"),Object($["a"])(je,a,o,!1,null,"786562cc",null)),Oe=Se.exports;l["default"].use(i.a),l["default"].config.productionTip=!1,new l["default"]({render:function(e){return e(Oe)},data:{curIndex:"1"}}).$mount("#app")},"5f82":function(e,t,n){"use strict";n("3e06")},"6a82":function(e,t,n){},"85ec":function(e,t,n){},ac87:function(e,t,n){},c7f3:function(e,t,n){}});
//# sourceMappingURL=app.5a3db45c.js.map